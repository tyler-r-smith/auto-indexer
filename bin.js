#!/usr/bin/env node
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var S=_interopDefault(require("sanctuary")),chalk=_interopDefault(require("chalk")),path=_interopDefault(require("path")),fs=_interopDefault(require("fs")),program=_interopDefault(require("commander"));S.pipe([S.map(S.pipe([S.stripSuffix(".js")])),S.filter(S.isJust),S.sequence(S.Maybe),S.map(S.joinWith(", ")),S.map(e=>`export { ${e} }`)]);var folderContents=e=>fs.readdirSync(path.resolve(process.cwd(),e)),fsWriteFile=S.curry2((e,r)=>fs.writeFileSync(path.resolve(__dirname,e),r)),importStatementFromString=S.curry3((e,r,t)=>`import ${t.split(".")[0]} from './${path.relative(path.dirname(e),r)}/${t}'`),log=S.curry2((e,r="")=>(console.log(e,r),r));const exportStatementFromArray=S.pipe([S.map(S.pipe([S.stripSuffix(".js")])),S.filter(S.isJust),S.sequence(S.Maybe),S.map(S.joinWith(", ")),S.map(e=>`export { ${e} }`)]),indexJsFromArray=S.curry3((e,r,t)=>S.pipe([S.map(importStatementFromString(e)(r))])(t)),ifAisBReturnC=S.curry3((e,r,t)=>e===r?S.of(S.Either)(t):S.Left(S.Nothing)),importStatementForFolder=S.curry2((e,r)=>S.pipe([folderContents,indexJsFromArray(e)(r),S.unlines])(r)),writeIndexForFolder=S.curry3((e,r,t)=>S.pipe([folderContents,exportStatementFromArray,S.map(S.concat(importStatementForFolder(e)(r))),S.map(fsWriteFile(e)),log(chalk`{green Wrote {yellow ${e}} from: {yellow ${r}}:} `)])(r)),ifFileWriteIndexForfolder=S.curry2((e,r)=>S.pipe([S.map(S.concat(r)),writeIndexForFolder(e)(r)]));program.version("0.0.1").option("-f --folder [text]","Folder to watch").option("-i --index [text]","index file to write").parse(process.argv);const{index:index,folder:folder}=program;writeIndexForFolder(path.resolve(process.cwd(),index))(path.resolve(process.cwd(),folder))(""),fs.watch(path.resolve(process.cwd(),folder),(e,r)=>{ifFileWriteIndexForfolder(path.resolve(process.cwd(),index))(folder)(ifAisBReturnC("rename")(e)(r))});
